create or replace PROCEDURE BRECON_SUMMARY_PROCEDURE (REPORT_DATE VARCHAR2) IS
    V_REPORT_DATE DATE := TO_DATE(REPORT_DATE, 'DD-MM-YYYY');
BEGIN
    -- Create sequence if it does not exist
    BEGIN
        EXECUTE IMMEDIATE 'CREATE SEQUENCE BRECON_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE';
    EXCEPTION
        WHEN OTHERS THEN
            IF SQLCODE = -955 THEN
                NULL; -- Ignore error if sequence already exists
            ELSE
                RAISE; -- Raise any other exceptions
            END IF;
    END;

    -- Insert data into brecon_source_table
    INSERT INTO BRECON_SOURCE_TABLE (
        SRLNO, ACID, AMT_RESERVATION_IND, BANK_CODE, BANK_ID, BKDT_TRAN_FLG, BR_CODE, 
        CRNCY_CODE, CRNCY_HOL_CHK_DONE_FLG, CUST_ID, DEL_FLG, DEL_MEMO_PAD, DTH_INIT_SOL_ID, 
        EABFAB_UPD_FLG, ENTRY_DATE, ENTRY_USER_ID, FX_TRAN_AMT, GL_DATE, GL_SEGMENT_STRING, 
        GL_SUB_HEAD_CODE, GST_UPD_FLG, IMPL_CASH_PART_TRAN_FLG, INSTRMNT_ALPHA, INSTRMNT_DATE, 
        INSTRMNT_NUM, INSTRMNT_TYPE, ISO_FLG, LCHG_TIME, LCHG_USER_ID, LIFT_LIEN_FLG, MODULE_ID, 
        MUD_POOL_BAL_BUILD_FLG, NAVIGATION_FLG, PARTY_CODE, PART_TRAN_SRL_NUM, PART_TRAN_TYPE, 
        PRINCIPAL_PORTION_AMT, PRNT_ADVC_IND, PROXY_ACID, PROXY_POST_IND, PR_SRL_NUM, PSTD_DATE, 
        PSTD_FLG, PSTD_USER_ID, PTRAN_CHRG_EXISTS_FLG, PTTM_EVENT_TYPE, RATE, RATE_CODE, 
        RCRE_TIME, RCRE_USER_ID, REFERRAL_ID, REF_AMT, REF_CRNCY_CODE, REF_NUM, 
        REGULARIZATION_AMT, RESERVATION_AMT, RESTRICT_MODIFY_IND, REVERSAL_DATE, 
        REVERSAL_VALUE_DATE, RPT_CODE, SERIAL_NUM, SI_ORG_EXEC_DATE, SI_SRL_NUM, SOL_ID, 
        SVS_TRAN_ID, SYS_PART_TRAN_CODE, TF_ENTITY_SOL_ID, TOD_ENTITY_TYPE, TOD_ENTITY_ID, 
        TRAN_AMT, TRAN_CRNCY_CODE, TRAN_DATE, TRAN_FREE_CODE1, TRAN_FREE_CODE2, TRAN_ID, 
        TRAN_PARTICULAR, TRAN_PARTICULAR_2, TRAN_PARTICULAR_CODE, TRAN_RMKS, TRAN_SUB_TYPE, 
        TRAN_TYPE, TREA_RATE, TREA_REF_NUM, TR_STATUS, TS_CNT, UAD_MODULE_ID, UAD_MODULE_KEY, 
        USER_PART_TRAN_CODE, VALUE_DATE, VFD_DATE, VFD_USER_ID, VOUCHER_PRINT_FLG, REPORT_DATE
    )
    SELECT  
        BRECON_SEQ.NEXTVAL, ACID, AMT_RESERVATION_IND, BANK_CODE, BANK_ID, BKDT_TRAN_FLG, BR_CODE, 
        CRNCY_CODE, CRNCY_HOL_CHK_DONE_FLG, CUST_ID, DEL_FLG, DEL_MEMO_PAD, DTH_INIT_SOL_ID, 
        EABFAB_UPD_FLG, ENTRY_DATE, ENTRY_USER_ID, FX_TRAN_AMT, GL_DATE, GL_SEGMENT_STRING, 
        GL_SUB_HEAD_CODE, GST_UPD_FLG, IMPL_CASH_PART_TRAN_FLG, INSTRMNT_ALPHA, INSTRMNT_DATE, 
        INSTRMNT_NUM, INSTRMNT_TYPE, ISO_FLG, LCHG_TIME, LCHG_USER_ID, LIFT_LIEN_FLG, MODULE_ID, 
        MUD_POOL_BAL_BUILD_FLG, NAVIGATION_FLG, PARTY_CODE, PART_TRAN_SRL_NUM, PART_TRAN_TYPE, 
        PRINCIPAL_PORTION_AMT, PRNT_ADVC_IND, PROXY_ACID, PROXY_POST_IND, PR_SRL_NUM, PSTD_DATE, 
        PSTD_FLG, PSTD_USER_ID, PTRAN_CHRG_EXISTS_FLG, PTTM_EVENT_TYPE, RATE, RATE_CODE, 
        RCRE_TIME, RCRE_USER_ID, REFERRAL_ID, REF_AMT, REF_CRNCY_CODE, REF_NUM, 
        REGULARIZATION_AMT, RESERVATION_AMT, RESTRICT_MODIFY_IND, REVERSAL_DATE, 
        REVERSAL_VALUE_DATE, RPT_CODE, SERIAL_NUM, SI_ORG_EXEC_DATE, SI_SRL_NUM, SOL_ID, 
        SVS_TRAN_ID, SYS_PART_TRAN_CODE, TF_ENTITY_SOL_ID, TOD_ENTITY_TYPE, TOD_ENTITY_ID, 
        TRAN_AMT, TRAN_CRNCY_CODE, TRAN_DATE, TRAN_FREE_CODE1, TRAN_FREE_CODE2, TRAN_ID, 
        TRAN_PARTICULAR, TRAN_PARTICULAR_2, TRAN_PARTICULAR_CODE, TRAN_RMKS, TRAN_SUB_TYPE, 
        TRAN_TYPE, TREA_RATE, TREA_REF_NUM, TR_STATUS, TS_CNT, UAD_MODULE_ID, UAD_MODULE_KEY, 
        USER_PART_TRAN_CODE, VALUE_DATE, VFD_DATE, VFD_USER_ID, VOUCHER_PRINT_FLG, V_REPORT_DATE
    FROM 
        HIST_TRAN_DTL_TABLE
    WHERE 
        REPORT_DATE = V_REPORT_DATE;

END;