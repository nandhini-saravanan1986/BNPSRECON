create or replace PROCEDURE BRECON_MAPPING_AUTO_PROCEDURE AS
    V_REPORT_DATE DATE;
BEGIN
    -- Set V_REPORT_DATE to the current system date (today at 00:00:00)
    V_REPORT_DATE := TRUNC(SYSDATE);
    INSERT INTO BRECON_COMMON_TABLE (
        ACCOUNT_NO,
        ACID,
        AMT_RESERVATION_IND,
        BANK_CODE,
        BANK_ID,
        BKDT_TRAN_FLG,
        BR_CODE,
        CANONICALIZATIONMETHOD_ALGORITHM,
        CREATE_TIME,
        CREATE_USER,
        CRNCY_CODE,
        CRNCY_HOL_CHK_DONE_FLG,
        CUST_ID,
        DEL_FLG,
        DEL_MEMO_PAD,
        DIGESTMETHOD_ALGORITHM,
        DTH_INIT_SOL_ID,
        EABFAB_UPD_FLG,
        ENTITY_FLG,
        ENTRY_DATE,
        ENTRY_USER_ID,
        FX_TRAN_AMT,
        GL_DATE,
        GL_SEGMENT_STRING,
        GL_SUB_HEAD_CODE,
        GRPHDR_BANK_IDENTIFIER_CODE,
        GRPHDR_CREATION_DATE_TIME,
        GRPHDR_LAST_PAGE_INDICATOR,
        GRPHDR_MESSAGE_IDENTIFIER,
        GRPHDR_NAME,
        GRPHDR_PAGE_NUMBER,
        GST_UPD_FLG,
        IMPL_CASH_PART_TRAN_FLG,
        INSTRMNT_ALPHA,
        INSTRMNT_DATE,
        INSTRMNT_NUM,
        INSTRMNT_TYPE,
        ISO_FLG,
        LCHG_TIME,
        LCHG_USER_ID,
        LIFT_LIEN_FLG,
        MODIFY_FLG,
        MODIFY_TIME,
        MODIFY_USER,
        MODULE_ID,
        MUD_POOL_BAL_BUILD_FLG,
        NAVIGATION_FLG,
        NTRY_ACCOUNT_SERVICER_REFERENCE,
        NTRY_AMOUNT_CURRENCY,
        NTRY_BOOKING_DATE,
        NTRY_BOOKING_DATE_TIME,
        NTRY_BRCH_CDTDBTINT,
        NTRY_BTCH_CURRENCY,
        NTRY_BTCH_MSG_ID,
        NTRY_BTCH_NUMOFTXS,
        NTRY_BTCH_TTLAMT,
        NTRY_CDTRAGT_BICFI_CREDIT,
        NTRY_CODE,
        NTRY_CREDIT_DEBIT_INDICATOR,
        NTRY_DBTRAGT_BICFI_DEBIT,
        NTRY_ENTRY_REFERENCE,
        NTRY_FININSTNID_BICFI,
        NTRY_INSTRUCTED_AMOUNT,
        NTRY_PROPRIETARY_CODE,
        NTRY_REFS_ACCOUNT_SERVICER_REFERENCE,
        NTRY_REFS_CLEARING_SYSTEM_REFERENCE,
        NTRY_REFS_END_TO_END_IDENTIFICATION,
        NTRY_REFS_INSTRUCTION_ID,
        NTRY_REFS_MESSAGE_IDENTIFIER,
        NTRY_REFS_PMTINFID,
        NTRY_REFS_TRANSACTION_ID,
        NTRY_REFS_UETR,
        NTRY_TRANSACTION_AMOUNT,
        NTRY_TXDTLS_AMOUNT_CURRENCY,
        NTRY_TXDTLS_CREDIT_DEBIT_INDICATOR,
        NTRY_VALUE_DATE,
        NTRY_VALUE_DATE_TIME,
        PARTY_CODE,
        PART_TRAN_SRL_NUM,
        PART_TRAN_TYPE,
        PRINCIPAL_PORTION_AMT,
        PRNT_ADVC_IND,
        PROXY_ACID,
        PROXY_POST_IND,
        PR_SRL_NUM,
        PSTD_DATE,
        PSTD_FLG,
        PSTD_USER_ID,
        PTRAN_CHRG_EXISTS_FLG,
        PTTM_EVENT_TYPE,
        RATE,
        RATE_CODE,
        RCRE_TIME,
        RCRE_USER_ID,
        RECON_DATE,
        RECON_FLAG,
        REFERRAL_ID,
        REF_AMT,
        REF_CRNCY_CODE,
        REF_NUM,
        REGULARIZATION_AMT,
        REPORT_DATE,
        REPORT_FROM_DATE,
        REPORT_NAME,
        REPORT_TO_DATE,
        RESERVATION_AMT,
        RESTRICT_MODIFY_IND,
        REVERSAL_DATE,
        REVERSAL_VALUE_DATE,
        RPT_CODE,
        SERIAL_NUM,
        SIGNATUREMETHOD_ALGORITHM,
        SIGNATURE_KEYINFO_X509_CERTIFICATE,
        SIGNATURE_KEYINFO_X509_SUBJECT_NAME,
        SIGNATURE_SIGNEDINFO_DIGEST_VALUE,
        SIGNATURE_SIGNEDINFO_SIGNATURE_VALUE,
        SI_ORG_EXEC_DATE,
        SI_SRL_NUM,
        SOL_ID,
        SRLNO,
        STMT_ACCOUNT_IDENTIFIER,
        STMT_BAL1_AMOUNT,
        STMT_BAL1_CODE_OR_PROPRIETARY,
        STMT_BAL1_CREDIT_DEBIT_INDICATOR,
        STMT_BAL1_DATE,
        STMT_BAL1_DATE_TIME,
        STMT_BAL_AMOUNT,
        STMT_BAL_CODE_OR_PROPRIETARY,
        STMT_BAL_CREDIT_DEBIT_INDICATOR,
        STMT_BAL_DATE,
        STMT_BAL_DATE_TIME,
        STMT_CREATION_DATE_TIME,
        STMT_ELECTRONIC_SEQUENCE_NUMBER,
        STMT_FROM_DATE_TIME,
        STMT_RELATED_ACCOUNT_IDENTIFIER,
        STMT_STATEMENT_IDENTIFIER,
        STMT_TO_DATE_TIME,
        SVS_TRAN_ID,
        SYS_PART_TRAN_CODE,
        TF_ENTITY_SOL_ID,
        TOD_ENTITY_ID,
        TOD_ENTITY_TYPE,
        TRANSACTION_CURRENCY,
        TRANSFORM_ALGORITHM,
        TRAN_AMT,
        TRAN_CRNCY_CODE,
        TRAN_DATE,
        TRAN_FREE_CODE1,
        TRAN_FREE_CODE2,
        TRAN_ID,
        TRAN_PARTICULAR,
        TRAN_PARTICULAR_2,
        TRAN_PARTICULAR_CODE,
        TRAN_RMKS,
        TRAN_SUB_TYPE,
        TRAN_TYPE,
        TREA_RATE,
        TREA_REF_NUM,
        TR_STATUS,
        TS_CNT,
        TXSSUMMRY_AMOUNT,
        TXSSUMMRY_CREDIT_DEBIT_INDICATOR,
        TXSSUMMRY_CREDIT_NUMBER_OF_ENTRIES,
        TXSSUMMRY_CREDIT_SUM,
        TXSSUMMRY_DEBIT_NUMBER_OF_ENTRIES,
        TXSSUMMRY_DEBIT_SUM,
        TXSSUMMRY_NUMBER_OF_ENTRIES,
        TXSSUMMRY_SUM,
        UAD_MODULE_ID,
        UAD_MODULE_KEY,
        USER_PART_TRAN_CODE,
        VALUE_DATE,
        VERIFY_TIME,
        VERIFY_USER,
        VFD_DATE,
        VFD_USER_ID,
        VOUCHER_PRINT_FLG
    )
    SELECT 
        B.ACCOUNT_NO,
        A.ACID,
        A.AMT_RESERVATION_IND,
        A.BANK_CODE,
        A.BANK_ID,
        A.BKDT_TRAN_FLG,
        A.BR_CODE,
        B.CANONICALIZATIONMETHOD_ALGORITHM,
        A.CREATE_TIME,
        A.CREATE_USER,
        A.CRNCY_CODE,
        A.CRNCY_HOL_CHK_DONE_FLG,
        A.CUST_ID,
        A.DEL_FLG,
        A.DEL_MEMO_PAD,
        B.DIGESTMETHOD_ALGORITHM,
        A.DTH_INIT_SOL_ID,
        A.EABFAB_UPD_FLG,
        A.ENTITY_FLG,
        A.ENTRY_DATE,
        A.ENTRY_USER_ID,
        TO_NUMBER(A.FX_TRAN_AMT), -- Ensure correct data type
        A.GL_DATE,
        A.GL_SEGMENT_STRING,
        A.GL_SUB_HEAD_CODE,
        B.GRPHDR_BANK_IDENTIFIER_CODE,
        B.GRPHDR_CREATION_DATE_TIME,
        B.GRPHDR_LAST_PAGE_INDICATOR,
        B.GRPHDR_MESSAGE_IDENTIFIER,
        B.GRPHDR_NAME,
        B.GRPHDR_PAGE_NUMBER,
        A.GST_UPD_FLG,
        A.IMPL_CASH_PART_TRAN_FLG,
        A.INSTRMNT_ALPHA,
        A.INSTRMNT_DATE,
        A.INSTRMNT_NUM,
        A.INSTRMNT_TYPE,
        A.ISO_FLG,
        A.LCHG_TIME,
        A.LCHG_USER_ID,
        A.LIFT_LIEN_FLG,
        A.MODIFY_FLG,
        A.MODIFY_TIME,
        A.MODIFY_USER,
        A.MODULE_ID,
        A.MUD_POOL_BAL_BUILD_FLG,
        A.NAVIGATION_FLG,
        B.NTRY_ACCOUNT_SERVICER_REFERENCE,
        TO_NUMBER(B.NTRY_AMOUNT_CURRENCY), -- Ensure correct data type
        B.NTRY_BOOKING_DATE,
        B.NTRY_BOOKING_DATE_TIME,
        B.NTRY_BRCH_CDTDBTINT,
        B.NTRY_BTCH_CURRENCY,
        B.NTRY_BTCH_MSG_ID,
        TO_NUMBER(B.NTRY_BTCH_NUMOFTXS), -- Ensure correct data type
        TO_NUMBER(B.NTRY_BTCH_TTLAMT), -- Ensure correct data type
        B.NTRY_CDTRAGT_BICFI_CREDIT,
        B.NTRY_CODE,
        B.NTRY_CREDIT_DEBIT_INDICATOR,
        B.NTRY_DBTRAGT_BICFI_DEBIT,
        B.NTRY_ENTRY_REFERENCE,
        B.NTRY_FININSTNID_BICFI,
        TO_NUMBER(B.NTRY_INSTRUCTED_AMOUNT), -- Ensure correct data type
        B.NTRY_PROPRIETARY_CODE,
        B.NTRY_REFS_ACCOUNT_SERVICER_REFERENCE,
        B.NTRY_REFS_CLEARING_SYSTEM_REFERENCE,
        B.NTRY_REFS_END_TO_END_IDENTIFICATION,
        B.NTRY_REFS_INSTRUCTION_ID,
        B.NTRY_REFS_MESSAGE_IDENTIFIER,
        B.NTRY_REFS_PMTINFID,
        B.NTRY_REFS_TRANSACTION_ID,
        B.NTRY_REFS_UETR,
        TO_NUMBER(B.NTRY_TRANSACTION_AMOUNT), -- Ensure correct data type
        TO_NUMBER(B.NTRY_TXDTLS_AMOUNT_CURRENCY), -- Ensure correct data type
        B.NTRY_TXDTLS_CREDIT_DEBIT_INDICATOR,
        B.NTRY_VALUE_DATE,
        B.NTRY_VALUE_DATE_TIME,
        A.PARTY_CODE,
        A.PART_TRAN_SRL_NUM,
        A.PART_TRAN_TYPE,
        TO_NUMBER(A.PRINCIPAL_PORTION_AMT), -- Ensure correct data type
        A.PRNT_ADVC_IND,
        A.PROXY_ACID,
        A.PROXY_POST_IND,
        A.PR_SRL_NUM,
        A.PSTD_DATE,
        A.PSTD_FLG,
        A.PSTD_USER_ID,
        A.PTRAN_CHRG_EXISTS_FLG,
        A.PTTM_EVENT_TYPE,
        TO_NUMBER(A.RATE), -- Ensure correct data type
        A.RATE_CODE,
        A.RCRE_TIME,
        A.RCRE_USER_ID,
        A.RECON_DATE,
        A.RECON_FLAG,
        A.REFERRAL_ID,
        TO_NUMBER(A.REF_AMT), -- Ensure correct data type
        A.REF_CRNCY_CODE,
        A.REF_NUM,
        TO_NUMBER(A.REGULARIZATION_AMT), -- Ensure correct data type
        V_REPORT_DATE,  -- Use the local variable here
        A.REPORT_FROM_DATE,
        B.REPORT_NAME,
        A.REPORT_TO_DATE,
        TO_NUMBER(A.RESERVATION_AMT), -- Ensure correct data type
        A.RESTRICT_MODIFY_IND,
        A.REVERSAL_DATE,
        A.REVERSAL_VALUE_DATE,
        A.RPT_CODE,
        A.SERIAL_NUM,
        B.SIGNATUREMETHOD_ALGORITHM,
        B.SIGNATURE_KEYINFO_X509_CERTIFICATE,
        B.SIGNATURE_KEYINFO_X509_SUBJECT_NAME,
        B.SIGNATURE_SIGNEDINFO_DIGEST_VALUE,
        B.SIGNATURE_SIGNEDINFO_SIGNATURE_VALUE,
        A.SI_ORG_EXEC_DATE,
        A.SI_SRL_NUM,
        A.SOL_ID,
        A.SRLNO,
        B.STMT_ACCOUNT_IDENTIFIER,
        TO_NUMBER(B.STMT_BAL1_AMOUNT), -- Ensure correct data type
        B.STMT_BAL1_CODE_OR_PROPRIETARY,
        B.STMT_BAL1_CREDIT_DEBIT_INDICATOR,
        B.STMT_BAL1_DATE,
        B.STMT_BAL1_DATE_TIME,
        TO_NUMBER(B.STMT_BAL_AMOUNT), -- Ensure correct data type
        B.STMT_BAL_CODE_OR_PROPRIETARY,
        B.STMT_BAL_CREDIT_DEBIT_INDICATOR,
        B.STMT_BAL_DATE,
        B.STMT_BAL_DATE_TIME,
        B.STMT_CREATION_DATE_TIME,
        B.STMT_ELECTRONIC_SEQUENCE_NUMBER,
        B.STMT_FROM_DATE_TIME,
        B.STMT_RELATED_ACCOUNT_IDENTIFIER,
        B.STMT_STATEMENT_IDENTIFIER,
        B.STMT_TO_DATE_TIME,
        A.SVS_TRAN_ID,
        A.SYS_PART_TRAN_CODE,
        A.TF_ENTITY_SOL_ID,
        A.TOD_ENTITY_ID,
        A.TOD_ENTITY_TYPE,
        B.TRANSACTION_CURRENCY,
        B.TRANSFORM_ALGORITHM,
        TO_NUMBER(A.TRAN_AMT), -- Ensure correct data type
        A.TRAN_CRNCY_CODE,
        A.TRAN_DATE,
        A.TRAN_FREE_CODE1,
        A.TRAN_FREE_CODE2,
        A.TRAN_ID,
        A.TRAN_PARTICULAR,
        A.TRAN_PARTICULAR_2,
        A.TRAN_PARTICULAR_CODE,
        A.TRAN_RMKS,
        A.TRAN_SUB_TYPE,
        A.TRAN_TYPE,
        TO_NUMBER(A.TREA_RATE), -- Ensure correct data type
        A.TREA_REF_NUM,
        A.TR_STATUS,
        TO_NUMBER(A.TS_CNT), -- Ensure correct data type
        TO_NUMBER(B.TXSSUMMRY_AMOUNT), -- Ensure correct data type
        B.TXSSUMMRY_CREDIT_DEBIT_INDICATOR,
        TO_NUMBER(B.TXSSUMMRY_CREDIT_NUMBER_OF_ENTRIES), -- Ensure correct data type
        TO_NUMBER(B.TXSSUMMRY_CREDIT_SUM), -- Ensure correct data type
        TO_NUMBER(B.TXSSUMMRY_DEBIT_NUMBER_OF_ENTRIES), -- Ensure correct data type
        TO_NUMBER(B.TXSSUMMRY_DEBIT_SUM), -- Ensure correct data type
        TO_NUMBER(B.TXSSUMMRY_NUMBER_OF_ENTRIES), -- Ensure correct data type
        TO_NUMBER(B.TXSSUMMRY_SUM), -- Ensure correct data type
        A.UAD_MODULE_ID,
        A.UAD_MODULE_KEY,
        A.USER_PART_TRAN_CODE,
        A.VALUE_DATE,
        A.VERIFY_TIME,
        A.VERIFY_USER,
        A.VFD_DATE,
        A.VFD_USER_ID,
        A.VOUCHER_PRINT_FLG
    FROM 
        BRECON_SOURCE_TABLE A
    JOIN 
        BRECON_DESTINATION_TABLE B ON 
        A.TRAN_PARTICULAR = B.NTRY_ENTRY_REFERENCE
    WHERE A.TRAN_DATE = V_REPORT_DATE;

    COMMIT;
END;