create or replace PROCEDURE KYC_IND_SUMMARY_PROCEDURE(REPORT_DATE VARCHAR2) IS
   
    V_REPORT_DATE DATE := TO_DATE(REPORT_DATE, 'DD-MM-YYYY');
BEGIN

    INSERT INTO KYC_IND (
        CUSTOMER_ID,
        ACCOUNT_TYPE,
        NAME,
        DATE_OF_BIRTH,
        PLACE_OF_BIRTH,
        OCCUPATION,
        ANNUAL_INCOME,

        PRIMARY_ADDRESS,
        PRIMARY_ADDRESS_COUNTRY,
        PRIMARY_ADDRESS_CITY,
        MOBILE_NUMBER,
        PRIMARY_TELEPHONE,
        SECONDARY_TELEPHONE,
        EMAIL_ID,
        REPORT_DATE 
    )
    SELECT 
        ORGKEY AS CUSTOMER_ID,
        ACCOUNTTYPE AS ACCOUNT_TYPE,
        NAME,
        CUST_DOB AS DATE_OF_BIRTH,
        PLACEOFBIRTH AS PLACE_OF_BIRTH,
        OCCUPATION,
        ANNUALREVENUE AS ANNUAL_INCOME,

        ADDRESS_LINE1 AS PRIMARY_ADDRESS,
        COUNTRY AS PRIMARY_ADDRESS_COUNTRY,
        CITY AS PRIMARY_ADDRESS_CITY,
        PHONE AS MOBILE_NUMBER,
        PHONE_HOME AS PRIMARY_TELEPHONE,
        PHONE_HOME2 AS SECONDARY_TELEPHONE,
        EMAIL AS EMAIL_ID,
        V_REPORT_DATE


    FROM 
        crmuser.ACCOUNTS;

    COMMIT;
    UPDATE KYC_IND
SET del_flg = 'N';
commit;
END ;